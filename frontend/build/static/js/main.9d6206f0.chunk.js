(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/close_icon.4c6a2169.svg"},,,,,,,,function(e,t,a){e.exports=a.p+"static/media/logo.51772f7c.svg"},function(e,t,a){e.exports=a.p+"static/media/edit_icon.58afbe73.svg"},function(e,t,a){e.exports=a.p+"static/media/add_icon.bdfb8ebb.svg"},function(e,t,a){e.exports=a.p+"static/media/change_avatar.34c46850.svg"},function(e,t,a){e.exports=a.p+"static/media/trash.48bb334e.svg"},function(e,t,a){e.exports=a.p+"static/media/auth_ok.7fc4c149.svg"},function(e,t,a){e.exports=a.p+"static/media/auth_false.c32299fa.svg"},,function(e,t,a){e.exports=a(36)},,,,,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(17),r=a.n(c),l=a(5),i=(a(35),a(4)),s=a(3),u=o.a.createContext(),m=o.a.createContext(),p=a(18),d=a.n(p);var h=function(e){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{src:d.a,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"}),e.loggedIn?o.a.createElement("div",{className:"header__user-info"},o.a.createElement("span",null,e.userEmail),o.a.createElement("button",{onClick:e.onLogout,type:"button",className:"header__logout-button"},"\u0412\u044b\u0439\u0442\u0438")):o.a.createElement("nav",{className:"header__nav-links"},o.a.createElement(l.c,{to:"/sign-in",className:function(e){var t=e.isActive;return"header__link ".concat(t?"header__link_hide":"")}},"\u0412\u043e\u0439\u0442\u0438"),o.a.createElement(l.c,{to:"/sign-up",className:function(e){var t=e.isActive;return"header__link ".concat(t?"header__link_hide":"")}},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")))},f=a(19),_=a.n(f),g=a(20),E=a.n(g),b=a(21),v=a.n(b),k=a(22),C=a.n(k);var N=function(e){var t,a,n=o.a.useContext(u),c=e.owner===n._id;return o.a.createElement("li",{className:"element"},c&&o.a.createElement("button",{className:"element__delete-button",type:"button"},o.a.createElement("img",{src:C.a,onClick:function(){e.handleDeleteClick(e.card)},alt:"\u0443\u0434\u0430\u043b\u0438\u0442\u044c"})),o.a.createElement("img",{src:e.link,alt:"\u0444\u043e\u0442\u043e: ".concat(e.name),className:"element__image",onClick:e.handleCardClick}),o.a.createElement("h2",{className:"element__title"},e.name),o.a.createElement("button",{type:"button",onClick:function(){e.handleLikeClick(e.card)},className:"element__like".concat((t=e.likes,a=n._id,t.some(function(e){return e===a})?" element__like_active":""))}),o.a.createElement("p",{className:"element__likes-count"},e.likes.length))};var y=function(e){var t=o.a.useContext(u),a=o.a.useContext(m);return o.a.createElement("main",null,o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__avatar"},o.a.createElement("button",{type:"button",className:"profile__avatar-button",onClick:e.onEditAvatar},o.a.createElement("img",{src:v.a,alt:"\u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"})),o.a.createElement("img",{className:"profile__avatar-image",src:t.avatar,alt:"\u0430\u0432\u0430\u0442\u0430\u0440"})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("h1",{className:"profile__title"},t.name),o.a.createElement("p",{className:"profile__subtitle"},t.about),o.a.createElement("button",{type:"button",className:"profile__edit-button",onClick:e.onEditProfile},o.a.createElement("img",{className:"profile__edit-button-icon",src:_.a,alt:"\u043a\u043d\u043e\u043f\u043a\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438"}))),o.a.createElement("button",{className:"profile__add-button",type:"button",onClick:e.onAddPlace},o.a.createElement("img",{className:"profile__add-button-icon",src:E.a,alt:"\u043a\u043d\u043e\u043f\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438"}))),o.a.createElement("ul",{className:"elements",id:"elements-container"},a?a.map(function(t){return o.a.createElement(N,{key:t._id,id:t.id,link:t.link,name:t.name,owner:t.owner,likes:t.likes,handleCardClick:e.onCardClick,handleLikeClick:e.onCardLike,card:t,handleDeleteClick:e.onCardDelete})}):""))};var O=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},j=a(6),U=a(7),S=new(function(){function e(t){Object(j.a)(this,e),this._apiUrl=t.apiUrl,this._token=t.token,this._pathToCards=t.pathToCards,this._pathToMyCard=t.pathToMyCard,this._pathToMyAvatar=t.pathToMyAvatar}return Object(U.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"_getApiData",value:function(e){var t=localStorage.getItem("jwt");return fetch(e,{headers:{Authorization:"Bearer ".concat(t)}}).then(this._checkResponse).then(function(e){return e})}},{key:"_setApiData",value:function(e,t,a){var n=localStorage.getItem("jwt");return fetch(e,{method:a,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(t)}).then(this._checkResponse).then(function(e){return e})}},{key:"getInitialCards",value:function(){return this._getApiData("".concat(this._apiUrl).concat(this._pathToCards))}},{key:"getUserInfo",value:function(){return this._getApiData("".concat(this._apiUrl).concat(this._pathToMyCard))}},{key:"setUserInfo",value:function(e){return this._setApiData("".concat(this._apiUrl).concat(this._pathToMyCard),e,"PATCH")}},{key:"setNewCard",value:function(e){return this._setApiData("".concat(this._apiUrl).concat(this._pathToCards),e,"POST")}},{key:"changeAvatar",value:function(e){return this._setApiData("".concat(this._apiUrl).concat(this._pathToMyCard).concat(this._pathToMyAvatar),e,"PATCH")}},{key:"deleteCard",value:function(e){var t=localStorage.getItem("jwt");return fetch("".concat(this._apiUrl).concat(this._pathToCards,"/").concat(e),{method:"DELETE",headers:{authorization:"Bearer ".concat(t)}}).then(this._checkResponse).then(function(e){return e})}},{key:"toggleLike",value:function(e,t){var a=localStorage.getItem("jwt");return fetch("".concat(this._apiUrl).concat(this._pathToCards,"/").concat(e,"/likes"),{method:t,headers:{authorization:"Bearer ".concat(a)}}).then(this._checkResponse).then(function(e){return e})}}]),e}())({apiUrl:"http://api.maxim-runkov.nomoreparties.co",pathToCards:"/cards",pathToMyCard:"/users/me",pathToMyAvatar:"/avatar"}),T=a(10),A=a.n(T);var w=function(e){return o.a.createElement("div",{className:"popup popup-".concat(e.name," ").concat(e.isOpen?"popup_opened":"")},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{className:"popup__close-button",type:"button",onClick:e.onClose},o.a.createElement("img",{src:A.a,alt:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close-icon"})),o.a.createElement("h2",{className:"popup__title"},e.title),o.a.createElement("form",{onSubmit:e.handleSubmit,action:"post",className:"form edit-form",name:"".concat(e.name,"-form"),noValidate:!0},e.children,o.a.createElement("button",{type:"submit",className:"form-submit form__submit-button"},e.buttonName))))};var x=function(e){var t=o.a.useContext(u),a=o.a.useState(""),n=Object(s.a)(a,2),c=n[0],r=n[1],l=o.a.useState(""),i=Object(s.a)(l,2),m=i[0],p=i[1];return o.a.useEffect(function(){t&&(r(t&&t.name?t.name:""),p(t&&t.about?t.about:""))},[t,e.isOpen]),o.a.createElement(w,{name:"edit",onClose:e.onClose,isOpen:e.isOpen,handleSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:m})},title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:o.a.createElement(o.a.Fragment,null,o.a.createElement("label",{className:"form__label",htmlFor:"edit-name"},o.a.createElement("input",{id:"edit-name",value:c,onChange:function(e){r(e.target.value)},type:"text",className:"form__input",name:"name",placeholder:"\u0418\u043c\u044f",required:!0,minLength:2,maxLength:40}),o.a.createElement("span",{className:"error-message edit-name-error"},"\u0442\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438")),o.a.createElement("label",{className:"form__label",htmlFor:"edit-profession"},o.a.createElement("input",{id:"edit-profession",value:m,onChange:function(e){p(e.target.value)},type:"text",className:"form__input",name:"description",placeholder:"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f",required:!0,minLength:2,maxLength:200}),o.a.createElement("span",{className:"error-message edit-profession-error"},"\u0442\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438")))})};var D=function(e){var t=o.a.useRef(),a=o.a.useContext(u);return o.a.createElement(w,{name:"change-avatar",onClose:e.onClose,isOpen:e.isOpen,title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",handleSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({_id:a._id,avatar:t.current.value}),n.target.reset()},children:o.a.createElement(o.a.Fragment,null,o.a.createElement("label",{className:"form__label",htmlFor:"change-avatar-url"},o.a.createElement("input",{ref:t,id:"change-avatar-url",type:"url",className:"form__input",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),o.a.createElement("span",{className:"error-message change-avatar-url-error"},"\u0442\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438")))})};var I=function(e){var t=o.a.useRef(),a=o.a.useRef();return o.a.createElement(w,{name:"add",handleSubmit:function(n){n.preventDefault(),e.onAddPlace({name:t.current.value,link:a.current.value}),n.target.reset()},onClose:e.onClose,isOpen:e.isOpen,title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonName:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",children:o.a.createElement(o.a.Fragment,null,o.a.createElement("label",{className:"form__label",htmlFor:"add-name"},o.a.createElement("input",{ref:t,id:"add-name",type:"text",className:"form__input",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:2,maxLength:30}),o.a.createElement("span",{className:"error-message add-name-error"},"\u0442\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438")),o.a.createElement("label",{className:"form__label",htmlFor:"add-url"},o.a.createElement("input",{ref:a,id:"add-url",type:"url",className:"form__input",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),o.a.createElement("span",{className:"error-message add-url-error"},"\u0442\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438")))})},L=a(1);var z=function(e){var t=Object(n.useState)(""),a=Object(s.a)(t,2),c=a[0],r=a[1],l=Object(n.useState)(""),i=Object(s.a)(l,2),u=i[0],m=i[1];return o.a.createElement(o.a.Fragment,null,e.loggedIn?o.a.createElement(L.a,{to:"/"}):o.a.createElement("main",null,o.a.createElement("h1",{className:"page-title"},"\u0412\u0445\u043e\u0434"),o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onLogin({password:c,email:u})},action:"post",className:"form authorization-form",name:"login-form",noValidate:!0},o.a.createElement("input",{onChange:function(e){m(e.target.value)},value:u,type:"email",className:"authorization-form__input",placeholder:"Email"}),o.a.createElement("input",{onChange:function(e){r(e.target.value)},value:c,type:"password",className:"authorization-form__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),o.a.createElement("button",{type:"submit",className:"authorization-form__button"},"\u0412\u043e\u0439\u0442\u0438"))))};var P=function(e){var t=Object(n.useState)(""),a=Object(s.a)(t,2),c=a[0],r=a[1],i=Object(n.useState)(""),u=Object(s.a)(i,2),m=u[0],p=u[1];return o.a.createElement(o.a.Fragment,null,e.loggedIn?o.a.createElement(L.a,{to:"/"}):o.a.createElement("main",null,o.a.createElement("h1",{className:"page-title"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onRegister({password:c,email:m})},action:"post",className:"form authorization-form",name:"login-form",noValidate:!0},o.a.createElement("input",{type:"email",value:m,onChange:function(e){p(e.target.value)},className:"authorization-form__input",placeholder:"Email"}),o.a.createElement("input",{type:"password",value:c,onChange:function(e){r(e.target.value)},className:"authorization-form__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),o.a.createElement("button",{type:"submit",className:"authorization-form__button"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),o.a.createElement("p",{className:"authorization-disclaimer"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",o.a.createElement(l.b,{to:"/sign-in",className:"authorization-disclaimer__link"},"\u0412\u043e\u0439\u0442\u0438")))))};var R=function(e){return o.a.createElement("div",{className:"popup image-popup ".concat(e.card?"popup_opened":"")},o.a.createElement("div",{className:"popup__image-wrapper"},o.a.createElement("button",{type:"button",className:"popup__close-button image-popup__close-icon",onClick:e.onClose},o.a.createElement("img",{src:A.a,alt:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close-icon"})),o.a.createElement("img",{src:e.card?e.card.src:"",alt:e.card?e.card.alt:"",className:"image-popup__image"}),o.a.createElement("p",{className:"image-popup__description"},e.card?e.card.alt:"")))},M=a(23),F=a.n(M),q=a(24),B=a.n(q);var J=function(e){return o.a.createElement("div",{className:"popup info-popup ".concat(e.isOpen?"popup_opened":"")},o.a.createElement("div",{className:"popup__container info-popup__wrapper"},o.a.createElement("button",{type:"button",className:"popup__close-button image-popup__close-icon",onClick:e.onClose},o.a.createElement("img",{src:A.a,alt:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close-icon"})),o.a.createElement("img",{src:e.isOkay?F.a:B.a,alt:"#",className:"info-popup__image"}),o.a.createElement("p",{className:"info-popup__description"},e.isOkay?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.")))},V=new(function(){function e(t){Object(j.a)(this,e),this._apiUrl=t.baseUrl,this._authUrl=t.authUrl,this._pathToMyCard=t.pathToMyCard,this._registerUrl=t.registerUrl}return Object(U.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"_setApiData",value:function(e,t){return fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(this._checkResponse).then(function(e){return e})}},{key:"checkAuthorization",value:function(e){return fetch("".concat(this._apiUrl).concat(this._pathToMyCard),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._checkResponse).then(function(e){return e})}},{key:"registerUserRequest",value:function(e){return this._setApiData("".concat(this._apiUrl).concat(this._registerUrl),e)}},{key:"authorizeUserRequest",value:function(e){return this._setApiData("".concat(this._apiUrl).concat(this._authUrl),e)}}]),e}())({baseUrl:"http://api.maxim-runkov.nomoreparties.co",authUrl:"/signin",pathToMyCard:"/users/me",registerUrl:"/signup",checkUrl:""}),H=a(25),G=function(e){var t=e.element,a=Object(H.a)(e,["element"]);return a.loggedIn?o.a.createElement(t,a):o.a.createElement(L.a,{to:"/sign-in",replace:!0})};var K=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(!1),l=Object(s.a)(r,2),p=l[0],d=l[1],f=Object(n.useState)(!1),_=Object(s.a)(f,2),g=_[0],E=_[1],b=Object(n.useState)(null),v=Object(s.a)(b,2),k=v[0],C=v[1],N=Object(n.useState)({name:"\u0418\u0437\u044f",about:"\u0428\u043d\u0438\u043f\u043f\u0435\u0440\u0441\u043e\u043d",avatar:"https://oir.mobi/uploads/posts/2020-01/1578161586_1-2.jpg",_id:"a29965ee4a6c3634590e40bc"}),j=Object(s.a)(N,2),U=j[0],T=j[1],A=o.a.useState([]),w=Object(s.a)(A,2),M=w[0],F=w[1],q=Object(n.useState)(""),B=Object(s.a)(q,2),H=B[0],K=B[1],Q=Object(n.useState)(!1),W=Object(s.a)(Q,2),X=W[0],Y=W[1],Z=Object(n.useState)(!1),$=Object(s.a)(Z,2),ee=$[0],te=$[1],ae=Object(n.useState)(!1),ne=Object(s.a)(ae,2),oe=ne[0],ce=ne[1];function re(){E(!1),c(!1),d(!1),te(!1),C(null)}function le(){var e=localStorage.getItem("jwt");e?V.checkAuthorization(e).then(function(e){K(e.data.email),Y(!0)}).catch(function(e){console.log(e),K(""),Y(!1)}):(K(""),Y(!1))}function ie(e){V.authorizeUserRequest(e).then(function(t){localStorage.setItem("jwt",t.token),K(e.email),Y(!0)}).catch(function(e){console.log(e)})}return Object(n.useEffect)(function(){X&&(Promise.resolve(S.getInitialCards()).then(function(e){F(e.data)}).catch(function(e){console.log(e)}),Promise.resolve(S.getUserInfo()).then(function(e){T(e.data)}).catch(function(e){console.log(e)}))},[X]),Object(n.useEffect)(function(){le()},[]),o.a.createElement(u.Provider,{value:U},o.a.createElement("div",{className:"page-wrapper"},o.a.createElement(h,{loggedIn:X,userEmail:H,onLogout:function(){localStorage.clear(),le()}}),o.a.createElement(m.Provider,{value:M},o.a.createElement(L.d,null,o.a.createElement(L.b,{path:"/",element:o.a.createElement(G,{element:y,loggedIn:X,onEditAvatar:function(){E(!0)},onEditProfile:function(){c(!0)},onAddPlace:function(){d(!0)},onCardClick:function(e){C(e.target)},card:k,onCardLike:function(e){var t=e.likes.some(function(e){return e===U._id});S.toggleLike(e._id,t?"DELETE":"PUT").then(function(t){F(function(a){return a.map(function(a){return a._id===e._id?t.data:a})})}).catch(function(e){console.log(e)})},onCardDelete:function(e){S.deleteCard(e._id).then(function(t){t&&F(function(t){return t.filter(function(t){return t._id!==e._id})})}).catch(function(e){console.log(e)})}})}),o.a.createElement(L.b,{path:"/sign-in",element:o.a.createElement(z,{onLogin:ie,loggedIn:X})}),o.a.createElement(L.b,{path:"/sign-up",element:o.a.createElement(P,{onRegister:function(e){V.registerUserRequest(e).then(function(){ie(e),ce(!0)}).catch(function(e){console.log(e),ce(!1)}).finally(function(){te(!0)})},loggedIn:X})}))),o.a.createElement(O,null)),o.a.createElement(x,{isOpen:a,onClose:re,onUpdateUser:function(e){S.setUserInfo(e).then(function(e){T(e.data),re()}).catch(function(e){console.log("\u041e\u0428\u0418\u0411\u041a\u0410! ".concat(e))})}}),o.a.createElement(I,{isOpen:p,onClose:re,onAddPlace:function(e){S.setNewCard(e).then(function(e){F([e.data].concat(Object(i.a)(M))),re()}).catch(function(e){console.log("\u041e\u0428\u0418\u0411\u041a\u0410! ".concat(e))})}}),o.a.createElement(D,{isOpen:g,onClose:re,onUpdateAvatar:function(e){S.changeAvatar(e).then(function(e){T(e.data),re()}).catch(function(e){console.log("\u041e\u0428\u0418\u0411\u041a\u0410! ".concat(e))})}}),o.a.createElement(R,{card:k,onClose:re}),o.a.createElement(J,{isOpen:ee,isOkay:oe,onClose:re}))},Q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,37)).then(function(t){var a=t.getCLS,n=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),o(e),c(e),r(e)})};r.a.createRoot(document.getElementById("root")).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(l.a,null,o.a.createElement(K,null)))),Q()}],[[26,1,2]]]);
//# sourceMappingURL=main.9d6206f0.chunk.js.map